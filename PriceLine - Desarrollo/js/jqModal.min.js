/*
 * jqModal - Minimalist Modaling with jQuery
 *
 * Copyright (c) 2007-2014 Brice Burgess @iceburg_net
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 * 
 * $Version: 2014.01.30 +r17 (aka 1.0.0)
 * Requires: jQuery 1.2.3+
 */
(function(e,t,n){$.fn.jqm=function(e){var t=$.extend({},$.jqm.params,e);return this.each(function(){var e=$(this),n=$(this).data("jqm");if(!n)n={ID:p++};e.data("jqm",$.extend(t,n)).addClass("jqm-init");t.trigger&&$(this).jqmAddTrigger(t.trigger)})};$.fn.jqmAddTrigger=function(e){return this.each(function(){if(!a($(this),"jqmShow",e))r("jqmAddTrigger must be called on initialized modals")})};$.fn.jqmAddClose=function(e){return this.each(function(){if(!a($(this),"jqmHide",e))r("jqmAddClose must be called on initialized modals")})};$.fn.jqmShow=function(e){return this.each(function(){!this._jqmShown&&i($(this),e)})};$.fn.jqmHide=function(e){return this.each(function(){this._jqmShown&&s($(this),e)})};var r=function(e){if(t.console&&t.console.error)t.console.error(e)},i=function(e,n){var r=e.data("jqm"),n=n||t.event,i=parseInt(e.css("z-index")),i=i>0?i:3e3,s=$("<div></div>").addClass(r.overlayClass).css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":i-1,opacity:r.overlay/100}),o={w:e,c:r,o:s,t:n};e.css("z-index",i);if(r.ajax){var u=r.target||e,a=r.ajax;u=typeof u=="string"?$(u,e):$(u);if(a.substr(0,1)=="@")a=$(n).attr(a.substring(1));u.html(r.ajaxText).load(a,function(){r.onLoad&&r.onLoad.call(this,o);f(o)})}else{f(o)}},s=function(e,n){var r=e.data("jqm"),n=n||t.event,i={w:e,c:r,o:e.data("jqmv"),t:n};l(i)},o=function(e){if(e.c.overlay>0)e.o.prependTo("body");e.w.show();$.jqm.focusFunc(e.w);return true},u=function(e){e.w.hide()&&e.o&&e.o.remove();return true},a=function(e,t,n){if(!e.data("jqm"))return false;return $(n).each(function(){this[t]=this[t]||[];this[t].push(e)}).click(function(){var e=this;$.each(this[t],function(n,r){r[t](e)});return false})},f=function(e){var t=e.w,n=e.o,r=e.c;if(r.onShow(e)!==false){t[0]._jqmShown=true;if(r.modal){!d[0]&&c("bind");d.push(t)}else t.jqmAddClose(n);r.closeClass&&t.jqmAddClose($("."+r.closeClass,t));r.toTop&&n&&t.before('<span id="jqmP'+r.ID+'"></span>').insertAfter(n);t.data("jqmv",n)}},l=function(e){var t=e.w,n=e.o,r=e.c;if(r.onHide(e)!==false){t[0]._jqmShown=false;if(r.modal){d.pop();!d[0]&&c("unbind")}r.toTop&&n&&$("#jqmP"+r.ID).after(t).remove()}},c=function(e){$(document)[e]("keypress keydown mousedown",h)},h=function(e){var t=$(e.target).data("jqm")||$(e.target).parents(".jqm-init:first").data("jqm"),n=d[d.length-1].data("jqm");if(t&&t.ID==n.ID)return true;return $.jqm.focusFunc(n)},p=0,d=[];$.jqm={params:{overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:false,target:false,ajaxText:"",modal:false,toTop:false,onShow:o,onHide:u,onLoad:false},focusFunc:function(e){$(":input:visible:first",e).focus();return false}}})(jQuery,window)